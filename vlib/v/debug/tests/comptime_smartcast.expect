#!/usr/bin/env expect
spawn [lindex $argv 0]
set test_file [lindex $argv 1]

expect -ex "Break on \[main\] comptime_smartcast in ${test_file}:3\r\n"
expect "${test_file}:3 vdbg> " { send "p v\r" } timeout { exit 1 }
expect "v = 1 (int)" { send "c\r" } timeout { exit 1 }
expect "${test_file}:5 vdbg> " { send "p v\r" } timeout { exit 1 }
expect "v = true (bool)" { send "q\r" } timeout { exit 1 }
expect eof
